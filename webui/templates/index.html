<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HotWords</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;600&display=swap" rel="stylesheet">
  <style>body{font-family:'SF Pro Display',system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}</style>
  <meta name="color-scheme" content="light dark" />
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <div class="brand">HotWords</div>
      <div class="subtitle">实时热词统计与查询</div>
      <p class="intro">这是一个基于滑动窗口的中文热词统计与分析项目，支持中文分词与 Top-K 查询，提供 Web 界面配置与结果可视化（柱状图）。用于课堂作业、舆情监测与趋势分析演示。</p>
      <div class="cta-row">
        <button id="downloadBtn" class="btn">下载结果</button>
      </div>
      <div id="runLog" class="log"></div>
    </div>
  </header>

  <main class="content">
    <div class="two-col">
      <section class="card small">
        <h2>查询快照</h2>
        <div id="snapInfo" class="muted" style="margin-bottom:8px;">—</div>
        <div class="chart-wrap small">
          <button id="prevArrow" class="nav-arrow left" aria-label="上一张" title="上一张">&#x2039;</button>
          <canvas id="chart"></canvas>
          <button id="nextArrow" class="nav-arrow right" aria-label="下一张" title="下一张">&#x203A;</button>
        </div>
      </section>

      <section class="card small">
        <h2>文件输入模式</h2>
        <div class="grid two">
          <div class="field">
            <label>输入文件</label>
            <div class="input-row">
              <input id="input_file" value="{{ cfg.get('input_file','test_sentences.txt') }}" placeholder="当前使用的文件名" />
              <label class="btn file">
                选择文件
                <input type="file" id="inputFilePicker" accept=".txt,.log,.csv,.json" hidden />
              </label>
              <button id="uploadBtn" class="btn">上传</button>
            </div>
            <div id="uploadLog" class="log"></div>
          </div>
          <div class="field">
            <label>输出文件</label>
            <div class="input-row">
              <input id="output_file" value="{{ cfg.get('output_file','output.txt') }}" />
            </div>
          </div>
          <div class="field">
            <label>TopK</label>
            <input id="topk" type="number" min="1" value="{{ cfg.get('topk','10') }}" />
          </div>
          <div class="field">
            <label>窗口时长 (分钟)</label>
            <input id="time_range" type="number" min="1" value="{{ cfg.get('time_range','10') }}" />
          </div>
          
          <div class="field">
            <label>Normalize NFC</label>
            <select id="normalize">
              <option value="true" {% if cfg.get('normalize','true')=='true' %}selected{% endif %}>true</option>
              <option value="false" {% if cfg.get('normalize','true')=='false' %}selected{% endif %}>false</option>
            </select>
          </div>
        </div>
        <div class="cta-row left">
          <button id="runConfigBtn" class="btn primary">运行分析</button>
        </div>
      </section>
    </div>

    <section class="card large">
      <h2>终端输入模式</h2>
      <div class="grid two">
        <div class="field">
          <label>控制</label>
          <div class="input-row">
            <button id="consoleToggle" class="btn danger">启动终端</button>
          </div>
        </div>
        <div class="field">
          <label>批量输入（多行）</label>
          <div class="input-row" style="align-items:flex-start">
            <textarea id="consoleInput" class="terminal-textarea" rows="6" style="width:100%"></textarea>
            <button id="consoleSend" class="btn">发送</button>
          </div>
        </div>
      </div>
      <pre id="consoleOut" class="code" style="margin-top:10px;min-height:220px"></pre>
    </section>

  </main>

  <script src="/static/main.js"></script>
</body>
</html>
