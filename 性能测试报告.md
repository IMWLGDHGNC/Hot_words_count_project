# 性能测试报告

本报告记录 Hot_words_count 在本机上的文件批处理性能。测试在文件模式（work_type=1）下运行，每次修改 `config.ini` 的 `input_file` 并执行二进制，结果从输出文件尾部的指标中采集。

## 基本硬件
- CPU: 12th Gen Intel(R) Core(TM) i7-12700H
- RAM: 15.73 GB
- OS: Microsoft Windows 11 家庭中文版 (10.0.26200)

## 指标说明与计算方法
- 行数（lines）: 输出文件中的 `LineCount`。
- 吞吐（lines/sec）: 输出 `Throughput(lines/sec)`，计算方式为 $\text{Throughput} = \frac{\text{processed\_lines}}{\text{elapsed\_seconds}}$。
- 平均时延（ms/line）: 输出 `AvgLatency(ms/line)`，由累计处理时长/行数得到。
- 内存占用（MB）: Windows API `GetProcessMemoryInfo` 的工作集大小。
- 运行时间（s）: 由行数和吞吐计算 $\text{Runtime} = \frac{\text{lines}}{\text{throughput}}$。

## 测试结果

| 数据集 | 行数(lines) | 吞吐(lines/sec) | 运行时间(s) | 平均时延(ms/line) | 内存(MB) |
|---|---:|---:|---:|---:|---:|
| input1.txt | 12872 | 41792.2 | 0.31 | 0 | 142.559 |
| input2.txt | 11698 | 39495.8 | 0.30 | 8.55e-05 | 142.211 |
| input3.txt | 14930 | 37415.5 | 0.40 | 0 | 144.375 |

注：`AvgLatency(ms/line)` 以程序输出为准；某些样本显示为 0 或接近 0，表示在当前环境下单行处理极快，精度被整型或计时粒度压缩。

上述运行时间为通过 `lines/throughput` 计算得到的估算壁钟时间，方便横向比较。

## 复现实验步骤（文件模式）
1. 编辑 `config.ini`：
   - 设置 `work_type = 1`
   - 设置 `input_file = input1.txt`（或 input2.txt / input3.txt）
   - 可选：设置 `output_file = output_inputX.txt`
2. 运行可执行文件：
   ```powershell
   cmake --build build --config Debug
   .\build\hotwords.exe
   ```
3. 查看输出：
   - 在 `output/output_inputX.txt`（或你的 `output_file`）末尾找到：
     - `LineCount`
     - `Throughput(lines/sec)`
     - `AvgLatency(ms/line)`
     - `Memory(MB)`
4. 计算运行时间：
   - `Runtime(s) = LineCount / Throughput(lines/sec)`

## 备注
- 数据与词典不同会显著影响结果，建议在相同机器与配置下对比不同窗口大小、停用/敏感词策略、TopK 值对性能的影响。
- 若需要更稳定的延迟测量，可改为采用高分辨率计时器记录总壁钟时间并直出 `Runtime(s)`，或对 `processing_ms` 累计方式进行微调（例如包含 I/O）。
